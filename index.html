<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pixel Chef Tycoon ‚Äî Neon Diner</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      background: radial-gradient(circle at center, #111 0%, #000 100%);
      color: #0ff;
      font-family: 'Press Start 2P', cursive;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin: 5px;
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #0ff;
    }
    canvas {
      border: 4px solid #0ff;
      margin: 15px auto;
      display: block;
      background: #000;
      box-shadow: 0 0 15px #0ff, inset 0 0 10px #00f;
    }
    #hud {
      text-shadow: 0 0 5px #0ff, 0 0 15px #0ff;
    }
    #shop {
      display: none;
      margin-top: 20px;
      padding: 15px;
      border: 4px solid #f0f;
      background: #111;
      box-shadow: 0 0 20px #f0f, 0 0 30px #0ff;
    }
    #shop h2 {
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #0ff;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      background: #000;
      color: #0ff;
      border: 2px solid #0ff;
      font-family: inherit;
      cursor: pointer;
      text-shadow: 0 0 5px #0ff, 0 0 10px #0ff;
      box-shadow: 0 0 10px #0ff;
    }
    button:hover {
      background: #0ff;
      color: #000;
      text-shadow: none;
    }
    button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>üç≥ Pixel Chef Tycoon</h1>
  <canvas id="gameCanvas" width="500" height="300"></canvas>
  <p id="hud">Day 1 | Coins: 0</p>

  <div id="shop">
    <h2>üèÆ Neon Upgrades üèÆ</h2>
    <p id="shop-coins"></p>
    <button id="buy-timer">üî• Upgrade Grill Timer (Cost: 5)</button>
    <button id="buy-soup">ü•£ Upgrade Soup Stirring (Cost: 5)</button>
    <button id="next-day">‚ñ∂ Next Day</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const hud = document.getElementById("hud");
    const shopDiv = document.getElementById("shop");
    const shopCoins = document.getElementById("shop-coins");
    const btnTimer = document.getElementById("buy-timer");
    const btnSoup = document.getElementById("buy-soup");
    const btnNext = document.getElementById("next-day");

    // Persistent save
    let saveData = JSON.parse(localStorage.getItem("chefSaveNeon")) || {
      coins: 0,
      day: 1,
      grillUpgrade: 0,
      soupUpgrade: 0
    };

    // Game state
    let gameActive = false;
    let currentRecipe = null;
    let resultGiven = false;
    let customerVisible = false;
    let foodSlide = null;

    // Burger vars
    let grillTimer = 0;
    let grillMax;
    let pattyState = 0; // 0=raw,1=cooking,2=perfect,3=burnt
    let flipped = false;

    // Soup vars
    let soupProgress = 0;
    let soupTarget = 5;
    let stirring = false;
    let lastAngle = null;

    // Glow helpers
    function glowCircle(x, y, r, color) {
      ctx.shadowColor = color;
      ctx.shadowBlur = 20;
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI*2);
      ctx.fillStyle = color;
      ctx.fill();
      ctx.shadowBlur = 0;
    }
    function glowText(txt, x, y, color="#0ff") {
      ctx.shadowColor = color;
      ctx.shadowBlur = 15;
      ctx.fillStyle = color;
      ctx.fillText(txt, x, y);
      ctx.shadowBlur = 0;
    }

    function startDay() {
      currentRecipe = Math.random() < 0.5 ? "burger" : "soup";
      hud.textContent = `Day ${saveData.day} | Coins: ${saveData.coins} | Order: ${currentRecipe}`;
      shopDiv.style.display = "none";
      canvas.style.display = "block";
      resultGiven = false;
      customerVisible = true;
      foodSlide = null;

      if (currentRecipe === "burger") {
        grillTimer = 0;
        flipped = false;
        pattyState = 0;
        grillMax = 400 - saveData.grillUpgrade * 50;
      } else {
        soupProgress = 0;
        soupTarget = 3 + saveData.soupUpgrade;
        lastAngle = null;
      }

      gameActive = true;
    }

    function drawCustomer() {
      // Customer silhouette
      glowCircle(70, 220, 30, "#222");
      glowCircle(70, 180, 20, "#222");
      // Order sign
      glowText(currentRecipe==="burger"?"üçî":"ü•£", 55, 130, "#f0f");
    }

    function drawBurger() {
      glowText("Click patty to flip!", 180, 40, "#fff");

      // Grill
      ctx.fillStyle = "#333";
      ctx.fillRect(150, 180, 200, 10);

      // Patty
      let color = "#f00";
      if (grillTimer > 100) color = "#fa0";
      if (grillTimer > 200) { color = "#f0f"; pattyState = 2; }
      if (grillTimer > 300) { color = "#500"; pattyState = 3; }

      glowCircle(250, 160, 25, color);
    }

    function drawSoup() {
      glowText("Stir in circles!", 190, 40, "#fff");
      // Bowl
      glowCircle(250, 160, 60, "#09f");
      glowCircle(250, 160, 50, "#000");

      // Soup
      glowCircle(250, 160, 45, "#f50");

      // Bubbling
      if (soupProgress > 0) {
        glowCircle(240+Math.sin(Date.now()/200)*5, 140, 5, "#ff0");
        glowCircle(260+Math.cos(Date.now()/300)*5, 150, 4, "#ff0");
      }
    }

    function animateFoodToCustomer(icon) {
      let x = 250, y = 160;
      let targetX = 100, targetY = 160;
      foodSlide = { icon, x, y, targetX, targetY, progress: 0 };
    }

    function gameLoop() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      if (customerVisible) drawCustomer();

      if (gameActive) {
        if (currentRecipe === "burger") {
          grillTimer++;
          drawBurger();
          if (pattyState===3 && !resultGiven) endCooking(false);
        } else {
          drawSoup();
          if (soupProgress >= soupTarget && !resultGiven) endCooking(true);
        }
      }

      if (foodSlide) {
        foodSlide.progress += 0.02;
        let x = foodSlide.x + (foodSlide.targetX - foodSlide.x) * foodSlide.progress;
        let y = foodSlide.y + (foodSlide.targetY - foodSlide.y) * foodSlide.progress;
        glowText(foodSlide.icon, x, y, "#0f0");
        if (foodSlide.progress >= 1) foodSlide = null;
      }

      requestAnimationFrame(gameLoop);
    }

    function endCooking(success) {
      resultGiven = true;
      gameActive = false;
      if (success) {
        animateFoodToCustomer(currentRecipe==="burger"?"üçî":"ü•£");
        saveData.coins += 3;
      }
      setTimeout(openShop, 1500);
    }

    canvas.addEventListener("click", e => {
      if (gameActive && currentRecipe==="burger" && !flipped) {
        flipped = true;
        if (pattyState===2) endCooking(true);
        else endCooking(false);
      }
    });

    canvas.addEventListener("mousemove", e => {
      if (gameActive && currentRecipe==="soup") {
        let dx = e.offsetX-250, dy = e.offsetY-160;
        let angle = Math.atan2(dy, dx);
        if (lastAngle!==null) {
          let delta = angle - lastAngle;
          if (delta > Math.PI) delta -= 2*Math.PI;
          if (delta < -Math.PI) delta += 2*Math.PI;
          if (Math.abs(delta) > 0.2) soupProgress += 0.1 + saveData.soupUpgrade*0.05;
        }
        lastAngle = angle;
      }
    });

    function openShop() {
      saveData.day++;
      saveGame();
      canvas.style.display = "none";
      shopDiv.style.display = "block";
      shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
      btnTimer.disabled = saveData.coins < 5;
      btnSoup.disabled = saveData.coins < 5;
    }

    btnTimer.onclick = () => {
      if (saveData.coins >= 5) {
        saveData.coins -= 5;
        saveData.grillUpgrade++;
        saveGame();
        shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
        btnTimer.disabled = saveData.coins < 5;
      }
    };

    btnSoup.onclick = () => {
      if (saveData.coins >= 5) {
        saveData.coins -= 5;
        saveData.soupUpgrade++;
        saveGame();
        shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
        btnSoup.disabled = saveData.coins < 5;
      }
    };

    btnNext.onclick = () => {
      saveGame();
      startDay();
    };

    function saveGame() {
      localStorage.setItem("chefSaveNeon", JSON.stringify(saveData));
    }

    startDay();
    gameLoop();
  </script>
</body>
</html>
