<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pixel Chef Tycoon ‚Äî Neon Diner</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      background: radial-gradient(circle at center, #111 0%, #000 100%);
      color: #0ff;
      font-family: 'Press Start 2P', cursive;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin: 5px;
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #0ff;
    }
    canvas {
      border: 4px solid #0ff;
      margin: 15px auto;
      display: block;
      background: #000;
      box-shadow: 0 0 15px #0ff, inset 0 0 10px #00f;
    }
    #hud {
      text-shadow: 0 0 5px #0ff, 0 0 15px #0ff;
    }
    #shop {
      display: none;
      margin-top: 20px;
      padding: 15px;
      border: 4px solid #f0f;
      background: #111;
      box-shadow: 0 0 20px #f0f, 0 0 30px #0ff;
    }
    #shop h2 {
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #0ff;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      background: #000;
      color: #0ff;
      border: 2px solid #0ff;
      font-family: inherit;
      cursor: pointer;
      text-shadow: 0 0 5px #0ff, 0 0 10px #0ff;
      box-shadow: 0 0 10px #0ff;
    }
    button:hover {
      background: #0ff;
      color: #000;
      text-shadow: none;
    }
    button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>üç≥ Pixel Chef Tycoon</h1>
  <canvas id="gameCanvas" width="400" height="200"></canvas>
  <p id="hud">Day 1 | Coins: 0</p>

  <div id="shop">
    <h2>üèÆ Neon Upgrades üèÆ</h2>
    <p id="shop-coins"></p>
    <button id="buy-timer">üî• Upgrade Grill Timer (Cost: 5)</button>
    <button id="buy-soup">ü•£ Upgrade Soup Stirring (Cost: 5)</button>
    <button id="next-day">‚ñ∂ Next Day</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const hud = document.getElementById("hud");
    const shopDiv = document.getElementById("shop");
    const shopCoins = document.getElementById("shop-coins");
    const btnTimer = document.getElementById("buy-timer");
    const btnSoup = document.getElementById("buy-soup");
    const btnNext = document.getElementById("next-day");

    // Persistent save
    let saveData = JSON.parse(localStorage.getItem("chefSaveNeon")) || {
      coins: 0,
      day: 1,
      grillUpgrade: 0,
      soupUpgrade: 0
    };

    // Game state
    let gameActive = false;
    let currentRecipe = null;
    let resultGiven = false;

    // Burger vars
    let grillTimer = 0;
    let grillMax;
    let flipZone = { min: 40, max: 60 };
    let flipped = false;

    // Soup vars
    let soupProgress = 0;
    let soupTarget = 5;
    let stirring = false;

    function startDay() {
      currentRecipe = Math.random() < 0.5 ? "burger" : "soup";
      hud.textContent = `Day ${saveData.day} | Coins: ${saveData.coins} | Order: ${currentRecipe}`;
      shopDiv.style.display = "none";
      canvas.style.display = "block";
      resultGiven = false;

      if (currentRecipe === "burger") {
        grillTimer = 0;
        flipped = false;
        grillMax = 100 - saveData.grillUpgrade * 10;
      } else {
        soupProgress = 0;
        soupTarget = 5 + saveData.soupUpgrade * 2;
      }

      gameActive = true;
    }

    function glowRect(x, y, w, h, color) {
      ctx.shadowColor = color;
      ctx.shadowBlur = 20;
      ctx.fillStyle = color;
      ctx.fillRect(x, y, w, h);
      ctx.shadowBlur = 0;
    }

    function glowCircle(x, y, r, color) {
      ctx.shadowColor = color;
      ctx.shadowBlur = 20;
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI*2);
      ctx.fillStyle = color;
      ctx.fill();
      ctx.shadowBlur = 0;
    }

    function drawBurger() {
      ctx.fillStyle = "#fff";
      ctx.fillText("üçî Burger: Press SPACE!", 100, 40);

      // Grill bar bg
      glowRect(50, 100, 300, 20, "#222");

      // Grill progress
      glowRect(50, 100, (grillTimer / grillMax) * 300, 20, flipped ? "#0f0" : "#f00");

      // Flip zone marker
      glowRect(50 + (flipZone.min/100)*300, 100,
               ((flipZone.max - flipZone.min)/100)*300, 20, "rgba(255,255,0,0.5)");
    }

    function drawSoup() {
      ctx.fillStyle = "#fff";
      ctx.fillText("ü•£ Soup: Stir with mouse!", 70, 40);

      // Bowl
      glowCircle(200, 100, 60, "#09f");
      glowCircle(200, 100, 50, "#000");

      // Steam effect (fake)
      glowCircle(200 + Math.sin(Date.now()/300)*10, 40, 5, "#0ff");
      glowCircle(190, 50, 4, "#0ff");
      glowCircle(210, 60, 3, "#0ff");

      // Progress bar
      glowRect(100, 160, 200, 15, "#333");
      glowRect(100, 160, (soupProgress / soupTarget) * 200, 15, "#0f0");
    }

    function gameLoop() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      if (gameActive) {
        if (currentRecipe === "burger") {
          grillTimer++;
          if (grillTimer > grillMax && !resultGiven) endCooking(false);
          drawBurger();
        } else {
          drawSoup();
          if (soupProgress >= soupTarget && !resultGiven) endCooking(true);
        }
      }

      requestAnimationFrame(gameLoop);
    }

    function endCooking(success) {
      resultGiven = true;
      gameActive = false;
      if (success) {
        alert(`Perfect ${currentRecipe}! +3 coins`);
        saveData.coins += 3;
      } else {
        alert(`${currentRecipe} failed! No coins earned.`);
      }
      openShop();
    }

    document.addEventListener("keydown", e => {
      if (gameActive && currentRecipe === "burger" && e.code === "Space" && !flipped) {
        flipped = true;
        let percent = (grillTimer / grillMax) * 100;
        if (percent >= flipZone.min && percent <= flipZone.max) {
          endCooking(true);
        } else {
          endCooking(false);
        }
      }
    });

    canvas.addEventListener("mousedown", () => { if (currentRecipe==="soup") stirring = true; });
    canvas.addEventListener("mouseup", () => { stirring = false; });
    canvas.addEventListener("mousemove", () => {
      if (gameActive && currentRecipe==="soup" && stirring) {
        soupProgress += 0.05 + saveData.soupUpgrade * 0.02;
      }
    });

    function openShop() {
      saveData.day++;
      saveGame();
      canvas.style.display = "none";
      shopDiv.style.display = "block";
      shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
      btnTimer.disabled = saveData.coins < 5;
      btnSoup.disabled = saveData.coins < 5;
    }

    btnTimer.onclick = () => {
      if (saveData.coins >= 5) {
        saveData.coins -= 5;
        saveData.grillUpgrade++;
        saveGame();
        shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
        btnTimer.disabled = saveData.coins < 5;
      }
    };

    btnSoup.onclick = () => {
      if (saveData.coins >= 5) {
        saveData.coins -= 5;
        saveData.soupUpgrade++;
        saveGame();
        shopCoins.textContent = `üí∞ You have ${saveData.coins} coins.`;
        btnSoup.disabled = saveData.coins < 5;
      }
    };

    btnNext.onclick = () => {
      saveGame();
      startDay();
    };

    function saveGame() {
      localStorage.setItem("chefSaveNeon", JSON.stringify(saveData));
    }

    startDay();
    gameLoop();
  </script>
</body>
</html>
